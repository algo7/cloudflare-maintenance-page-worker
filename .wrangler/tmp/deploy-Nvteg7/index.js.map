{
  "version": 3,
  "sources": ["../../../src/index.js"],
  "sourceRoot": "/home/algo7/Desktop/code/cloudflare-maintenance-page-worker/.wrangler/tmp/deploy-Nvteg7",
  "sourcesContent": ["/**\n * Welcome to Cloudflare Workers! This is your first worker.\n *\n * - Run `npm run dev` in your terminal to start a development server\n * - Open a browser tab at http://localhost:8787/ to see your worker in action\n * - Run `npm run deploy` to publish your worker\n *\n * Learn more at https://developers.cloudflare.com/workers/\n */\n\nexport default {\n\tasync fetch(request, env, ctx) {\n\n\t\tconst backendUrl = 'https://scraper.algo7.tools';\n\n\t\ttry {\n\t\t\t// Attempt to fetch from the backend\n\t\t\tconst backendResponse = await fetch(backendUrl, {\n\t\t\t\tmethod: 'HEAD', // Use a HEAD request for efficiency \n\t\t\t\theaders: {\n\t\t\t\t\t\"X-Source\": \"Cloudflare-Workers\"\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst logs = {\n\t\t\t\t'Client IP': request.headers.get('cf-connecting-ip'),\n\t\t\t\t'Client Country': request.headers.get('cf-ipcountry'),\n\t\t\t\t'Client City': request.cf.city,\n\t\t\t\t'Client Region': request.cf.region,\n\t\t\t\t'Backend Status': backendResponse.status,\n\t\t\t\t'Time': new Date().toISOString(),\n\t\t\t};\n\n\n\t\t\t// Log to console\n\t\t\tconsole.log(logs);\n\n\t\t\t// Write to KV\n\t\t\tawait env.MAINTENANCE_PAGE_LOGGING.put('logs', JSON.stringify(logs));\n\n\n\t\t\t// Backend is up\n\t\t\tif (backendResponse.ok) {\n\t\t\t\treturn fetch(request); // Pass the request to the backend\n\t\t\t} else {\n\t\t\t\t// Backend is down\n\t\t\t\treturn serveStatusPage();\n\t\t\t}\n\n\t\t} catch (error) {\n\t\t\t// Error contacting backend\n\t\t\tconsole.error(error);\n\t\t\treturn serveStatusPage();\n\t\t}\n\t},\n\n\n};\n\n\n\nfunction serveStatusPage() {\n\treturn new Response(`\n\t<!doctype html>\n\t<title>Site Maintenance</title>\n\t<style>\n\t  body { text-align: center; padding: 150px; }\n\t  h1 { font-size: 50px; }\n\t  body { font: 20px Helvetica, sans-serif; color: #333; }\n\t  article { display: block; text-align: left; width: 650px; margin: 0 auto; }\n\t  a { color: #dc8100; text-decoration: none; }\n\t  a:hover { color: #333; text-decoration: none; }\n\t</style>\n\t\n\t<article>\n\t\t<h1>We&rsquo;ll be back soon!</h1>\n\t\t<div>\n\t\t\t<p>Sorry for the inconvenience but we&rsquo;re performing some maintenance at the moment. If you need to you can always <a href=\"mailto:support@algo7.tools\">contact me</a>, otherwise we&rsquo;ll be back online shortly!</p>\n\t\t\t<p>&mdash; Algo7</p>\n\t\t</div>\n\t</article>\n\t`, {\n\t\tstatus: 503,\n\t\theaders: { 'Content-Type': 'text/html' }\n\t});\n}"],
  "mappings": ";AAUA,IAAO,cAAQ;AAAA,EACd,MAAM,MAAM,SAAS,KAAK,KAAK;AAE9B,UAAM,aAAa;AAEnB,QAAI;AAEH,YAAM,kBAAkB,MAAM,MAAM,YAAY;AAAA,QAC/C,QAAQ;AAAA;AAAA,QACR,SAAS;AAAA,UACR,YAAY;AAAA,QACb;AAAA,MACD,CAAC;AAED,YAAM,OAAO;AAAA,QACZ,aAAa,QAAQ,QAAQ,IAAI,kBAAkB;AAAA,QACnD,kBAAkB,QAAQ,QAAQ,IAAI,cAAc;AAAA,QACpD,eAAe,QAAQ,GAAG;AAAA,QAC1B,iBAAiB,QAAQ,GAAG;AAAA,QAC5B,kBAAkB,gBAAgB;AAAA,QAClC,SAAQ,oBAAI,KAAK,GAAE,YAAY;AAAA,MAChC;AAIA,cAAQ,IAAI,IAAI;AAGhB,YAAM,IAAI,yBAAyB,IAAI,QAAQ,KAAK,UAAU,IAAI,CAAC;AAInE,UAAI,gBAAgB,IAAI;AACvB,eAAO,MAAM,OAAO;AAAA,MACrB,OAAO;AAEN,eAAO,gBAAgB;AAAA,MACxB;AAAA,IAED,SAAS,OAAP;AAED,cAAQ,MAAM,KAAK;AACnB,aAAO,gBAAgB;AAAA,IACxB;AAAA,EACD;AAGD;AAIA,SAAS,kBAAkB;AAC1B,SAAO,IAAI,SAAS;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAmBjB;AAAA,IACF,QAAQ;AAAA,IACR,SAAS,EAAE,gBAAgB,YAAY;AAAA,EACxC,CAAC;AACF;",
  "names": []
}
